# ğŸ“˜ Î Î»Î®ÏÎ·Ï‚ Î¤ÎµÏ‡Î½Î¹ÎºÎ® Î¤ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ· - LanguageTranslate v2

**Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±**: Î”ÎµÎºÎ­Î¼Î²ÏÎ¹Î¿Ï‚ 2025  
**ÎˆÎºÎ´Î¿ÏƒÎ·**: 2.0  
**ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·**: Î Î±ÏÎ±Î³Ï‰Î³Î®Ï‚ (Production Ready)

---

## ğŸ¯ Î•Ï€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ· ÎˆÏÎ³Î¿Ï…

Î¤Î¿ **LanguageTranslate** ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± ÎµÏ€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¹ÎºÎ® Chrome Extension Ï€Î¿Ï… Ï€Î±ÏÎ­Ï‡ÎµÎ¹ **real-time Î¼ÎµÏ„Î¬Ï†ÏÎ±ÏƒÎ·** Î±Ï€ÏŒ Î®Ï‡Î¿ ÎºÎ±ÏÏ„Î­Î»Î±Ï‚ ÏƒÎµ ÎºÎµÎ¯Î¼ÎµÎ½Î¿, Î¼Îµ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· Ï€Î¿Î»Î»Î±Ï€Î»ÏÎ½ AI providers Î³Î¹Î± Î¼Î­Î³Î¹ÏƒÏ„Î· ÎµÏ…ÎµÎ»Î¹Î¾Î¯Î± ÎºÎ±Î¹ Ï€Î¿Î¹ÏŒÏ„Î·Ï„Î±.

### Î’Î±ÏƒÎ¹ÎºÎ® Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ®
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Chrome Browser                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Extension (Manifest V3)                         â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Popup UI (provider selection)               â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Content Script (HUD overlay)                â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Background Service Worker                   â”‚   â”‚
â”‚  â”‚  â””â”€â”€ Options Page                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ WebSocket
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FastAPI Backend (Python)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  WebSocket Endpoints (3 providers)               â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ /api/deepgram (300ms latency)               â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ /api/google-speech (500ms)                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€ /api/realtime (OpenAI, 1-2s)                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Translation Service                             â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ DeepL API (premium quality)                 â”‚   â”‚
â”‚  â”‚  â””â”€â”€ OpenAI GPT-4o-mini (fallback)               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ REST API
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              External AI Services                        â”‚
â”‚  â€¢ Deepgram Speech-to-Text API                          â”‚
â”‚  â€¢ Google Cloud Speech-to-Text API                      â”‚
â”‚  â€¢ OpenAI Realtime API                                  â”‚
â”‚  â€¢ DeepL Translation API                                â”‚
â”‚  â€¢ OpenAI GPT-4o-mini (syntax check + translation)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ Î”Î¿Î¼Î® ÎˆÏÎ³Î¿Ï…

```
LanguageTranslate/
â”œâ”€â”€ backend/                    # Python FastAPI backend
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ main.py            # FastAPI app entry point
â”‚   â”‚   â”œâ”€â”€ config.py          # Configuration settings
â”‚   â”‚   â”œâ”€â”€ api/               # WebSocket endpoints
â”‚   â”‚   â”‚   â”œâ”€â”€ deepgram_realtime.py   # Deepgram integration
â”‚   â”‚   â”‚   â”œâ”€â”€ google_realtime.py     # Google Speech integration
â”‚   â”‚   â”‚   â””â”€â”€ realtime.py            # OpenAI Realtime integration
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â””â”€â”€ translation_service.py # Translation abstraction layer
â”‚   â”œâ”€â”€ requirements.txt       # Python dependencies
â”‚   â”œâ”€â”€ pyproject.toml        # Python project config
â”‚   â””â”€â”€ .env                  # API keys (PRIVATE!)
â”‚
â”œâ”€â”€ extension/                 # Chrome Extension
â”‚   â”œâ”€â”€ manifest.json         # Extension configuration (MV3)
â”‚   â”œâ”€â”€ popup.html            # Popup UI
â”‚   â”œâ”€â”€ options.html          # Settings page
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ popup.ts          # Popup logic
â”‚   â”‚   â”œâ”€â”€ options.ts        # Options page logic
â”‚   â”‚   â”œâ”€â”€ background.ts     # Service worker
â”‚   â”‚   â”œâ”€â”€ content/
â”‚   â”‚   â”‚   â”œâ”€â”€ hud.ts        # Main HUD overlay
â”‚   â”‚   â”‚   â””â”€â”€ hudState.ts   # State management
â”‚   â”‚   â””â”€â”€ api/
â”‚   â”‚       â””â”€â”€ backendClient.ts # Backend communication
â”‚   â”œâ”€â”€ dist/                 # Compiled JavaScript (generated)
â”‚   â”œâ”€â”€ package.json          # Node dependencies
â”‚   â””â”€â”€ tsconfig.json         # TypeScript config
â”‚
â”œâ”€â”€ start-backend.ps1         # Automated backend starter
â”œâ”€â”€ README.md                 # English documentation
â”œâ”€â”€ Î“Î¡Î—Î“ÎŸÎ¡Î—_Î•ÎšÎšÎ™ÎÎ—Î£Î—.md       # Quick start guide (Greek)
â”œâ”€â”€ ÎŸÎ”Î—Î“ÎŸÎ£_Î§Î¡Î—Î£Î—Î£.md          # User guide (Greek)
â”œâ”€â”€ Î¤Î•Î§ÎÎ™ÎšÎ—_Î¤Î•ÎšÎœÎ—Î¡Î™Î©Î£Î—.md     # This file
â””â”€â”€ PROVIDERS_GUIDE.md        # Provider comparison
```

---

## ğŸ”„ Î¡Î¿Î® Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ (Data Flow)

### Î£ÎµÎ½Î¬ÏÎ¹Î¿: Live Translation Session

```
1. Î•ÎšÎšÎ™ÎÎ—Î£Î— (Initialization)
   User clicks extension icon
        â†“
   Popup opens â†’ Selects providers (Deepgram + DeepL)
        â†“
   Saves to chrome.storage.sync
        â†“
   User clicks "Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· HUD"
        â†“
   Content script shows HUD on page

2. CAPTURE Î—Î§ÎŸÎ¥ (Audio Capture)
   User clicks "Start captions" in HUD
        â†“
   navigator.mediaDevices.getDisplayMedia() â†’ Capture tab audio
        â†“
   MediaRecorder starts recording (PCM16, 24kHz)
        â†“
   Audio chunks â†’ 100ms intervals

3. TRANSCRIPTION (Speech-to-Text)
   Audio chunk sent via WebSocket
        â†“
   Backend receives at selected endpoint (/api/deepgram)
        â†“
   Forward to Deepgram API
        â†“
   Receive interim results (word-by-word streaming)
        â†“
   Send "partial" message to client â†’ Display immediately
        â†“
   Receive final result (end of utterance)
        â†“
   Send "original_complete" message

4. SYNTAX CHECK (Optional)
   Final transcript â†’ OpenAI GPT-4o-mini
        â†“
   "Fix any transcription errors"
        â†“
   Return corrected text
        â†“
   Send "original_corrected" if different

5. TRANSLATION
   Corrected text â†’ Translation service
        â†“
   Check user's translation provider preference
        â†“
   If DeepL selected & API key exists:
       Call DeepL API with language mapping
       (el â†’ EL, en â†’ EN-US, etc.)
        â†“
   Else:
       Call OpenAI GPT-4o-mini
        â†“
   Return translation
        â†“
   Send "translation" message to client

6. Î•ÎœÎ¦Î‘ÎÎ™Î£Î— (Display)
   HUD receives "partial" â†’ Shows streaming text with cursor (â–Š)
        â†“
   HUD receives "original_complete" â†’ Adds to history
        â†“
   HUD receives "translation" â†’ Shows translated text
        â†“
   Auto-scroll to bottom
        â†“
   Continue loop until user stops
```

---

## ğŸ™ï¸ Transcription Providers - Î›ÎµÏ€Ï„Î¿Î¼ÎµÏÎ®Ï‚ Î‘Î½Î¬Î»Ï…ÏƒÎ·

### 1. Deepgram (Î£Ï…Î½Î¹ÏƒÏ„ÏÎ¼ÎµÎ½Î¿)

**Î¤ÎµÏ‡Î½Î¹ÎºÎ¬ Î§Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬:**
- **Endpoint**: `wss://api.deepgram.com/v1/listen`
- **Model**: `nova-2` (newest, most accurate)
- **Audio Format**: PCM16, 24kHz, mono
- **Features Enabled**:
  - `interim_results=true` â†’ Word-by-word streaming
  - `utterance_end_ms=1000` â†’ Detect end of speech
  - `punctuate=true` â†’ Auto-punctuation
  - `smart_format=true` â†’ Smart formatting
  - `vad_events=true` â†’ Voice Activity Detection

**Î ÏÏ‚ Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯:**
```typescript
// Client sends audio chunks
websocket.send(audioBuffer); // Binary PCM16 data

// Server receives streaming results
{
  "type": "Results",
  "channel": {
    "alternatives": [{
      "transcript": "hello world",
      "confidence": 0.95
    }]
  },
  "is_final": false,      // Interim result
  "speech_final": false   // Not end of utterance
}

// Final result at end of utterance
{
  "type": "UtteranceEnd",
  ...
}
```

**Î Î»ÎµÎ¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î±:**
- âœ… Î¤Î±Ï‡ÏÏ„Î±Ï„Î¿ (~300ms Î±Ï€ÏŒ Î®Ï‡Î¿ ÏƒÎµ ÎºÎµÎ¯Î¼ÎµÎ½Î¿)
- âœ… True word-by-word streaming
- âœ… Î•Î¾Î±Î¹ÏÎµÏ„Î¹ÎºÎ® Î±ÎºÏÎ¯Î²ÎµÎ¹Î±
- âœ… $200 Î´Ï‰ÏÎµÎ¬Î½ credit ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÎµÎ³Î³ÏÎ±Ï†Î®

**API Key Setup:**
```env
DEEPGRAM_API_KEY=your_key_here
```

---

### 2. Google Cloud Speech-to-Text

**Î¤ÎµÏ‡Î½Î¹ÎºÎ¬ Î§Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬:**
- **Library**: `google-cloud-speech`
- **Model**: `latest_long`
- **Audio Format**: LINEAR16, 24kHz
- **Config**:
  ```python
  RecognitionConfig(
      encoding=LINEAR16,
      sample_rate_hertz=24000,
      language_code="en-US",
      enable_automatic_punctuation=True
  )
  StreamingRecognitionConfig(
      config=config,
      interim_results=True  # Streaming support
  )
  ```

**Î ÏÏ‚ Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯:**
```python
# Streaming recognition
responses = client.streaming_recognize(streaming_config, requests)

for response in responses:
    for result in response.results:
        if result.is_final:
            # Final transcript
            transcript = result.alternatives[0].transcript
        else:
            # Interim result
            interim = result.alternatives[0].transcript
```

**Î Î»ÎµÎ¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î±:**
- âœ… ÎšÎ±Î»Î® Î±ÎºÏÎ¯Î²ÎµÎ¹Î± (~500ms)
- âœ… Î”Ï‰ÏÎµÎ¬Î½ 60 Î»ÎµÏ€Ï„Î¬/Î¼Î®Î½Î±
- âœ… Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· Ï€Î¿Î»Î»ÏÎ½ Î³Î»Ï‰ÏƒÏƒÏÎ½

**Credentials Setup:**
```env
GOOGLE_CLOUD_CREDENTIALS=./backend/google-credentials.json
```

---

### 3. OpenAI Realtime API (Fallback)

**Î¤ÎµÏ‡Î½Î¹ÎºÎ¬ Î§Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬:**
- **Endpoint**: `wss://api.openai.com/v1/realtime`
- **Model**: `gpt-4o-realtime-preview`
- **Audio Format**: Base64-encoded PCM16
- **VAD Settings**:
  ```json
  {
    "type": "silence",
    "threshold": 0.15,
    "prefix_padding_ms": 100,
    "silence_duration_ms": 200
  }
  ```

**Î ÏÏ‚ Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯:**
```json
// Client sends audio
{
  "type": "input_audio_buffer.append",
  "audio": "base64_encoded_audio"
}

// Trigger transcription on silence
{
  "type": "input_audio_buffer.commit"
}

// Receive transcript
{
  "type": "conversation.item.created",
  "item": {
    "role": "user",
    "content": [{
      "transcript": "hello world"
    }]
  }
}
```

**Î§Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬:**
- âš ï¸ Î‘ÏÎ³ÏŒ (1-2 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±)
- âœ… Î ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹ ÏƒÎ¹Ï‰Ï€Î® Î³Î¹Î± Î½Î± ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÏ„ÎµÎ¯
- âœ… Î Î¬Î½Ï„Î± Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ (Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· OpenAI key)

---

## ğŸ§  Translation Providers - Î›ÎµÏ€Ï„Î¿Î¼ÎµÏÎ®Ï‚ Î‘Î½Î¬Î»Ï…ÏƒÎ·

### 1. DeepL API (Î£Ï…Î½Î¹ÏƒÏ„ÏÎ¼ÎµÎ½Î¿)

**Î¤ÎµÏ‡Î½Î¹ÎºÎ¬ Î§Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬:**
- **Endpoint**: 
  - Free tier: `https://api-free.deepl.com/v1/translate`
  - Pro tier: `https://api.deepl.com/v1/translate`
- **Authentication**: `DeepL-Auth-Key {key}`
- **Language Mapping**:
  ```python
  lang_map = {
      "el": "EL",      # Greek
      "en": "EN-US",   # English (US)
      "fr": "FR",      # French
      "de": "DE",      # German
      "es": "ES",      # Spanish
      "it": "IT",      # Italian
      "pt": "PT-BR",   # Portuguese (Brazil)
      "ja": "JA",      # Japanese
      "zh": "ZH"       # Chinese
  }
  ```

**Î ÏÏ‚ Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯:**
```python
async def _translate_deepl(text: str, target_lang: str):
    payload = {
        "text": text,
        "target_lang": lang_map.get(target_lang, target_lang.upper())
    }
    
    response = await client.post(
        self.deepl_endpoint,
        headers={"Authorization": f"DeepL-Auth-Key {self.deepl_key}"},
        data=payload
    )
    
    data = response.json()
    return data["translations"][0]["text"]
```

**Î Î»ÎµÎ¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î±:**
- âœ… **ÎšÎ±Î»ÏÏ„ÎµÏÎ· Ï€Î¿Î¹ÏŒÏ„Î·Ï„Î±** Î³Î¹Î± ÎµÏ…ÏÏ‰Ï€Î±ÏŠÎºÎ­Ï‚ Î³Î»ÏÏƒÏƒÎµÏ‚
- âœ… Î¦Ï…ÏƒÎ¹ÎºÏŒÏ„ÎµÏÎµÏ‚ Î¼ÎµÏ„Î±Ï†ÏÎ¬ÏƒÎµÎ¹Ï‚
- âœ… Î™Î´Î±Î½Î¹ÎºÏŒ Î³Î¹Î± Î•Î»Î»Î·Î½Î¹ÎºÎ¬ â†” Î‘Î³Î³Î»Î¹ÎºÎ¬
- âœ… 500,000 Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚/Î¼Î®Î½Î± Î´Ï‰ÏÎµÎ¬Î½

**API Key Setup:**
```env
DEEPL_API_KEY=your_key_here:fx  # :fx for free tier
```

---

### 2. OpenAI GPT-4o-mini (Fallback)

**Î¤ÎµÏ‡Î½Î¹ÎºÎ¬ Î§Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬:**
- **Model**: `gpt-4o-mini`
- **Temperature**: 0 (deterministic)
- **Max Tokens**: 500

**Î ÏÏ‚ Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯:**
```python
async def _translate_openai(text: str, target_lang: str):
    prompt = f"Translate to {target_lang}. Only output the translation."
    
    payload = {
        "model": "gpt-4o-mini",
        "messages": [
            {"role": "system", "content": prompt},
            {"role": "user", "content": text}
        ],
        "temperature": 0
    }
    
    response = await client.post(
        "https://api.openai.com/v1/chat/completions",
        headers={"Authorization": f"Bearer {api_key}"},
        json=payload
    )
    
    return response.json()["choices"][0]["message"]["content"]
```

**Î Î»ÎµÎ¿Î½ÎµÎºÏ„Î®Î¼Î±Ï„Î±:**
- âœ… Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ 100+ Î³Î»ÏÏƒÏƒÎµÏ‚
- âœ… ÎšÎ±Î»ÏŒ Î³Î¹Î± exotic Î³Î»ÏÏƒÏƒÎµÏ‚
- âœ… Î•Î½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î¿ syntax checking

---

## ğŸ¨ Frontend Architecture (Chrome Extension)

### Manifest V3 Structure

**manifest.json:**
```json
{
  "manifest_version": 3,
  "name": "LanguageTranslate",
  "permissions": ["storage", "tabs", "activeTab"],
  "host_permissions": ["<all_urls>"],
  "background": {
    "service_worker": "dist/background.js"
  },
  "action": {
    "default_popup": "popup.html"
  },
  "content_scripts": [{
    "matches": ["<all_urls>"],
    "js": ["dist/content/hud.js"],
    "run_at": "document_idle"
  }]
}
```

### Component Breakdown

#### 1. **Popup (popup.ts)**
Î¤Î¿ ÎºÏÏÎ¹Î¿ control panel Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·.

**Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚:**
- Provider selection (transcription + translation)
- Real-time tooltips Î¼Îµ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚
- ÎšÎ¿Ï…Î¼Ï€Î¯ "Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· HUD"
- Link ÏƒÎµ Settings

**State Management:**
```typescript
// Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÏƒÏ„Î¿ chrome.storage.sync
chrome.storage.sync.set({
  transcriptionProvider: 'deepgram',
  translationProvider: 'deepl'
});

// Î‘Î½Î¬ÎºÏ„Î·ÏƒÎ·
chrome.storage.sync.get(['transcriptionProvider'], (items) => {
  const provider = items.transcriptionProvider || 'deepgram';
});
```

**Message Passing:**
```typescript
// Î£Ï„Î­Î»Î½ÎµÎ¹ Î¼Î®Î½Ï…Î¼Î± ÏƒÏ„Î¿ content script Î½Î± Î±Î½Î¿Î¯Î¾ÎµÎ¹ Ï„Î¿ HUD
chrome.tabs.sendMessage(tabId, {
  type: "SHOW_HUD"
});
```

---

#### 2. **HUD Overlay (hud.ts)**
Î¤Î¿ ÎºÏÏÎ¹Î¿ UI Ï€Î¿Ï… Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î±.

**Î”Î¿Î¼Î®:**
```typescript
const HUD = {
  root: HTMLDivElement,           // Main container
  header: {
    title: HTMLDivElement,
    controls: {
      minimize: HTMLButtonElement,
      settings: HTMLButtonElement,
      theme: HTMLButtonElement,
      close: HTMLButtonElement
    }
  },
  languageRow: {
    sourceSelect: HTMLSelectElement,    // Source language
    targetSelect: HTMLSelectElement,    // Target language
    transcriptionSelect: HTMLSelectElement, // ğŸ™ï¸ Provider
    translationSelect: HTMLSelectElement    // ğŸ§  Provider
  },
  startStopBtn: HTMLButtonElement,
  statusLabel: HTMLDivElement,
  originalBox: HTMLDivElement,      // Original text display
  translatedBox: HTMLDivElement     // Translated text display
}
```

**WebSocket Communication:**
```typescript
// 1. Connect to backend
const provider = PROVIDERS[selectedProvider]; // 'deepgram', 'google', 'openai'
websocket = new WebSocket(provider.endpoint);

// 2. Send config on open
websocket.onopen = async () => {
  const translationProvider = await getTranslationProvider();
  
  websocket.send(JSON.stringify({
    type: "config",
    sourceLang: "auto",
    targetLang: "en",
    translationProvider: translationProvider  // 'deepl' or 'openai'
  }));
};

// 3. Send audio chunks
websocket.send(audioBuffer); // Binary data

// 4. Handle messages
websocket.onmessage = (event) => {
  const data = JSON.parse(event.data);
  
  switch(data.type) {
    case "partial":
      // Streaming word-by-word
      originalBox.textContent = data.text + "â–Š";
      break;
      
    case "original_complete":
      // Final transcript
      originalHistory.push(data.text);
      break;
      
    case "original_corrected":
      // Syntax-checked version
      originalBox.textContent = data.corrected;
      break;
      
    case "translation":
      // Final translation
      translatedBox.textContent = data.translation;
      translatedHistory.push(data.translation);
      break;
  }
};
```

**Drag & Resize:**
```typescript
// Dragging
header.addEventListener('mousedown', (e) => {
  isDragging = true;
  offsetX = e.clientX - root.offsetLeft;
  offsetY = e.clientY - root.offsetTop;
});

document.addEventListener('mousemove', (e) => {
  if (isDragging) {
    let newX = e.clientX - offsetX;
    let newY = e.clientY - offsetY;
    
    // Clamp to viewport
    newX = Math.max(0, Math.min(newX, window.innerWidth - root.offsetWidth));
    newY = Math.max(0, Math.min(newY, window.innerHeight - root.offsetHeight));
    
    root.style.left = newX + 'px';
    root.style.top = newY + 'px';
    
    saveHudState({ left: newX, top: newY });
  }
});

// Resizing (similar logic for 8 resize handles)
```

**State Persistence:**
```typescript
interface HudPersistedState {
  theme: 'light' | 'dark';
  top: number;
  left: number;
  width: number;
  height: number;
  sourceLang: string;
  targetLang: string;
  displayPrefs: {
    fontSizePx: number;
    textColor: string;
    backgroundColor: string;
    fontFamily: string;
    panelBackgroundColor: string;
    uiFontSizePx: number;
  };
  customFonts: Array<{name: string, value: string}>;
}

// Save
await saveHudState({
  theme: 'dark',
  displayPrefs: { fontSizePx: 24 }
});

// Load
const hudState = await loadHudState();
```

---

#### 3. **Options Page (options.ts)**
Î£ÎµÎ»Î¯Î´Î± ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ Î³Î¹Î± advanced configuration.

**Features:**
- Backend URL configuration
- Provider comparison table
- Transcription provider selection
- Translation provider selection
- Links to documentation

---

#### 4. **Background Service Worker (background.ts)**
Minimal worker Î³Î¹Î± message routing (Manifest V3 requirement).

```typescript
chrome.runtime.onInstalled.addListener(() => {
  console.log('LanguageTranslate installed');
});

// Message relay (if needed)
chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
  // Handle cross-component communication
});
```

---

## ğŸ” Security & API Keys

### Environment Variables (.env)

**Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± .env file:**
```env
# Backend Configuration
HOST=0.0.0.0
PORT=8000

# OpenAI (Required for fallback)
OPENAI_API_KEY=sk-proj-...your_key_here...

# Transcription Providers (choose at least one)
DEEPGRAM_API_KEY=your_deepgram_key_here
GOOGLE_CLOUD_CREDENTIALS=./google-credentials.json

# Translation Providers (choose at least one)
DEEPL_API_KEY=your_deepl_key_here:fx

# Models
OPENAI_TRANSLATION_MODEL=gpt-4o-mini
```

### Î‘ÏƒÏ†Î¬Î»ÎµÎ¹Î± API Keys

**âŒ Î ÎŸÎ¤Î• ÎœÎ—:**
- Commit Ï„Î¿ .env file ÏƒÏ„Î¿ git
- ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï‚ Ï„Î± API keys Î´Î·Î¼ÏŒÏƒÎ¹Î±
- Hardcode keys ÏƒÏ„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ±

**âœ… Î Î‘ÎÎ¤Î‘:**
- Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎµ .gitignore Î³Î¹Î± .env
- Î ÎµÏÎ¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹Ï‚ (rotate) keys Î±Î½ ÎµÎºÏ„ÎµÎ¸Î¿ÏÎ½
- Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎµ environment variables

---

## ğŸš€ Deployment & Production

### Backend Deployment

**Local Development:**
```bash
cd backend
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

**Production (Example with Docker):**
```dockerfile
FROM python:3.11-slim

WORKDIR /app
COPY backend/requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY backend/app ./app
COPY backend/.env .env

CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

**Cloud Hosting Options:**
- Railway.app (Free tier available)
- Heroku
- Google Cloud Run
- AWS Lambda (Î¼Îµ API Gateway)
- DigitalOcean App Platform

---

### Extension Distribution

**Development (Unpacked):**
1. `chrome://extensions/`
2. Enable "Developer mode"
3. "Load unpacked" â†’ Select `extension/` folder

**Production (Chrome Web Store):**
1. Build extension: `npm run build`
2. Zip the `extension/` folder
3. Upload to Chrome Web Store
4. Submit for review

---

## ğŸ“Š Performance Optimization

### Backend Optimizations

**1. WebSocket Connection Pooling:**
```python
# Reuse HTTP client connections
self._client = httpx.AsyncClient(timeout=10.0)
```

**2. Async/Await Î³Î¹Î± Î Î±ÏÎ¬Î»Î»Î·Î»ÎµÏ‚ Î•ÏÎ³Î±ÏƒÎ¯ÎµÏ‚:**
```python
# Syntax check ÎºÎ±Î¹ translation Ï„ÏÎ­Ï‡Î¿Ï…Î½ Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½Î±
asyncio.create_task(process_and_translate(websocket, text, target_lang))
```

**3. Streaming Response:**
```python
# Î”ÎµÎ½ Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ transcript
if interim_results:
    await websocket.send_json({"type": "partial", "text": transcript})
```

---

### Frontend Optimizations

**1. Debouncing Î³Î¹Î± UI Updates:**
```typescript
let updateTimeout;
function updateDisplay(text) {
  clearTimeout(updateTimeout);
  updateTimeout = setTimeout(() => {
    textBox.textContent = text;
  }, 50); // 50ms debounce
}
```

**2. Virtual Scrolling (Î³Î¹Î± Î¼ÎµÎ³Î¬Î»Î¿ history):**
```typescript
// ÎœÏŒÎ½Î¿ Ï„Î± Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± 50 items
const recentHistory = history.slice(-50);
```

**3. Efficient DOM Updates:**
```typescript
// Batch DOM updates
requestAnimationFrame(() => {
  originalBox.textContent = text1;
  translatedBox.textContent = text2;
});
```

---

## ğŸ§ª Testing & Debugging

### Backend Testing

**Test Health Endpoint:**
```bash
curl http://localhost:8000/health
# Response: {"status":"ok"}
```

**Test WebSocket (via Browser Console):**
```javascript
const ws = new WebSocket('ws://localhost:8000/api/deepgram');
ws.onopen = () => {
  ws.send(JSON.stringify({
    type: 'config',
    targetLang: 'en',
    translationProvider: 'deepl'
  }));
};
ws.onmessage = (e) => console.log(JSON.parse(e.data));
```

**FastAPI Docs:**
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

---

### Extension Testing

**Console Debugging:**
```typescript
// Content script console
console.log('[HUD]', 'WebSocket connected');

// Background worker console
chrome://serviceworker-internals/

// Extension popup console
Right-click extension icon â†’ Inspect popup
```

**Chrome Extension Reload:**
```typescript
// Programmatic reload
chrome.runtime.reload();
```

---

## ğŸ“ˆ Monitoring & Analytics

### Recommended Metrics

**Backend:**
- WebSocket connection count
- Average transcription latency
- API error rates
- Cost per minute (API usage)

**Frontend:**
- User sessions duration
- Provider selection distribution
- Error rates per provider
- HUD open/close events

### Logging

**Backend Logging:**
```python
import logging

logger = logging.getLogger(__name__)
logger.info(f"Client connected to {provider_name}")
logger.error(f"Translation error: {e}")
```

**Frontend Logging:**
```typescript
// Structured logging
console.log('[HUD]', { event: 'transcription_complete', duration: 1234 });
```

---

## ğŸ”® Future Improvements

### Planned Features

1. **Offline Mode**
   - Local Whisper model Î³Î¹Î± transcription
   - Cached translations

2. **Multi-Language Support**
   - Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î· Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ· Î³Î»ÏÏƒÏƒÎ±Ï‚
   - Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· Î³Î¹Î± 50+ Î³Î»ÏÏƒÏƒÎµÏ‚

3. **Advanced Analytics**
   - Usage statistics dashboard
   - Cost tracking per provider

4. **Collaboration Features**
   - Shared sessions
   - Export transcripts
   - Real-time collaboration

5. **Mobile Support**
   - Android/iOS app
   - Cross-platform sync

---

## ğŸ› Known Issues & Limitations

### Current Limitations

1. **Browser Support**: ÎœÏŒÎ½Î¿ Chrome/Chromium browsers
2. **Tab Audio Only**: Î”ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ±Ï„Î±Î³ÏÎ¬ÏˆÎµÎ¹ system audio
3. **Single Tab**: ÎœÏŒÎ½Î¿ Î­Î½Î± tab ÎºÎ¬Î¸Îµ Ï†Î¿ÏÎ¬
4. **Internet Required**: ÎŒÎ»Î± Ï„Î± API ÎµÎ¯Î½Î±Î¹ cloud-based

### Workarounds

**Î“Î¹Î± System Audio:**
- Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎµ Virtual Audio Cable
- Route system audio ÏƒÎµ browser tab

**Î“Î¹Î± Firefox:**
- Manifest V2 fork (in development)

---

## ğŸ“ Support & Community

### Resources
- **GitHub**: [Repository URL]
- **Documentation**: Î‘Ï…Ï„ÏŒ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ + ÎŸÎ”Î—Î“ÎŸÎ£_Î§Î¡Î—Î£Î—Î£.md
- **API Docs**: 
  - Deepgram: https://developers.deepgram.com
  - Google Speech: https://cloud.google.com/speech-to-text
  - DeepL: https://www.deepl.com/docs-api

### Getting Help

**Common Issues:**
1. Check Î“Î¡Î—Î“ÎŸÎ¡Î—_Î•ÎšÎšÎ™ÎÎ—Î£Î—.md Î³Î¹Î± setup
2. Verify backend is running: http://localhost:8000/health
3. Check browser console for errors (F12)
4. Verify API keys ÏƒÏ„Î¿ .env

---

## ğŸ“œ License

MIT License - Î”ÎµÏ‚ LICENSE file Î³Î¹Î± Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚.

---

## ğŸ“ Appendix: Glossary

**Terms:**
- **HUD**: Heads-Up Display (Ï„Î¿ overlay Ï€Î¿Ï… Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î±)
- **WebSocket**: Î ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î¿ Î³Î¹Î± real-time Î´Î¹ÎºÎ±Ï„ÎµÏ…Î¸Ï…Î½ÏŒÎ¼ÎµÎ½Î· ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±
- **Interim Results**: Î ÏÎ¿ÏƒÏ‰ÏÎ¹Î½Î¬ Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î± (streaming)
- **VAD**: Voice Activity Detection (Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ· Î¿Î¼Î¹Î»Î¯Î±Ï‚)
- **Latency**: ÎšÎ±Î¸Ï…ÏƒÏ„Î­ÏÎ·ÏƒÎ· Î±Ï€ÏŒ Î®Ï‡Î¿ ÏƒÎµ ÎºÎµÎ¯Î¼ÎµÎ½Î¿
- **PCM16**: Audio format (16-bit Pulse Code Modulation)

---

**Î¤ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·**: Î”ÎµÎºÎ­Î¼Î²ÏÎ¹Î¿Ï‚ 2025  
**Maintainer**: [Your Name]  
**Version**: 2.0.0
